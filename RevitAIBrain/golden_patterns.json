{
    "Create a star shaped wall": "var levels = new FilteredElementCollector(doc).OfClass(typeof(Level)).Cast<Level>().OrderBy(l => l.Elevation).ToList();\nLevel level = levels.FirstOrDefault();\nvar wallTypes = new FilteredElementCollector(doc).OfClass(typeof(WallType)).Cast<WallType>().Where(w => w.Kind == WallKind.Basic).ToList();\nWallType wt = wallTypes.FirstOrDefault();\n\nif (level == null) throw new Exception(\"No Levels found.\");\nif (wt == null) throw new Exception(\"No Basic Wall Types found.\");\n\ndouble radius = 10; \nList<XYZ> points = new List<XYZ>();\nfor (int i = 0; i < 5; i++)\n{\n    double angle = 2 * Math.PI * i / 5 - Math.PI / 2;\n    points.Add(new XYZ(radius * Math.Cos(angle), radius * Math.Sin(angle), 0));\n    double innerAngle = angle + Math.PI / 5;\n    points.Add(new XYZ(radius * 0.4 * Math.Cos(innerAngle), radius * 0.4 * Math.Sin(innerAngle), 0));\n}\n\nfor (int i = 0; i < points.Count; i++)\n{\n    XYZ p1 = points[i];\n    XYZ p2 = points[(i + 1) % points.Count];\n    Line line = Line.CreateBound(p1, p2);\n    Wall.Create(doc, line, wt.Id, level.Id, 10, 0, false, false);\n}",
    "Create a basic wall 4m high": "var levels = new FilteredElementCollector(doc).OfClass(typeof(Level)).Cast<Level>().OrderBy(l => l.Elevation).ToList();\nLevel level1 = levels.FirstOrDefault();\nvar wallTypes = new FilteredElementCollector(doc).OfClass(typeof(WallType)).Cast<WallType>().Where(w => w.Kind == WallKind.Basic).ToList();\nWallType wt = wallTypes.FirstOrDefault();\n\nif (level1 != null && wt != null)\n{\n    Line line = Line.CreateBound(new XYZ(0, 0, 0), new XYZ(10, 0, 0));\n    Wall.Create(doc, line, wt.Id, level1.Id, 13.1234, 0, false, false);\n}",
    "Create a generic floor": "var levels = new FilteredElementCollector(doc).OfClass(typeof(Level)).Cast<Level>().ToList();\nLevel level = levels.FirstOrDefault();\nvar floorTypes = new FilteredElementCollector(doc).OfClass(typeof(FloorType)).Cast<FloorType>().ToList();\nFloorType ft = floorTypes.FirstOrDefault();\n\nif (level != null && ft != null)\n{\n    CurveLoop profile = new CurveLoop();\n    profile.Append(Line.CreateBound(new XYZ(0, 0, 0), new XYZ(10, 0, 0)));\n    profile.Append(Line.CreateBound(new XYZ(10, 0, 0), new XYZ(10, 10, 0)));\n    profile.Append(Line.CreateBound(new XYZ(10, 10, 0), new XYZ(0, 10, 0)));\n    profile.Append(Line.CreateBound(new XYZ(0, 10, 0), new XYZ(0, 0, 0)));\n    \n    Floor.Create(doc, new List<CurveLoop> { profile }, ft.Id, level.Id);\n}",
    "Create a simple roof": "var levels = new FilteredElementCollector(doc).OfClass(typeof(Level)).Cast<Level>().OrderByDescending(l => l.Elevation).ToList();\nLevel level = levels.FirstOrDefault();\nvar roofTypes = new FilteredElementCollector(doc).OfClass(typeof(RoofType)).Cast<RoofType>().Where(r => r.Name.Contains(\"Generic\") || r.Name.Contains(\"Basic\")).ToList();\nRoofType rt = roofTypes.FirstOrDefault() ?? new FilteredElementCollector(doc).OfClass(typeof(RoofType)).Cast<RoofType>().FirstOrDefault();\n\nif (level == null) throw new Exception(\"No Levels found.\");\nif (rt == null) throw new Exception(\"No Roof Types found in project.\");\n\nCurveArray profile = new CurveArray();\nprofile.Append(Line.CreateBound(new XYZ(0, 0, 0), new XYZ(10, 0, 0)));\nprofile.Append(Line.CreateBound(new XYZ(10, 0, 0), new XYZ(10, 10, 0)));\nprofile.Append(Line.CreateBound(new XYZ(10, 10, 0), new XYZ(0, 10, 0)));\nprofile.Append(Line.CreateBound(new XYZ(0, 10, 0), new XYZ(0, 0, 0)));\n\nModelCurveArray modelCurves;\ndoc.Create.NewFootPrintRoof(profile, level, rt, out modelCurves);",
    "Dimension all grids": "var grids = new FilteredElementCollector(doc, doc.ActiveView.Id).OfClass(typeof(Grid)).Cast<Grid>().ToList();\nif (grids.Count > 1)\n{\n    ReferenceArray refs = new ReferenceArray();\n    foreach(var g in grids) refs.Append(new Reference(g));\n    Line line = Line.CreateBound(new XYZ(0,0,0), new XYZ(100,0,0));\n    doc.Create.NewDimension(doc.ActiveView, line, refs);\n}",
    "Tag all rooms": "var rooms = new FilteredElementCollector(doc, doc.ActiveView.Id).OfCategory(BuiltInCategory.OST_Rooms).WhereElementIsNotElementType().ToElements();\nforeach(var r in rooms) { if(r.Location is LocationPoint lp) { doc.Create.NewRoomTag(new LinkElementId(r.Id), new UV(lp.Point.X, lp.Point.Y), doc.ActiveView.Id); } }",
    "Tag all doors": "var doors = new FilteredElementCollector(doc, doc.ActiveView.Id).OfCategory(BuiltInCategory.OST_Doors).WhereElementIsNotElementType().ToElements();\nforeach(var d in doors) { if(d.Location is LocationPoint lp) { try { var tag = IndependentTag.Create(doc, doc.ActiveView.Id, new Reference(d), false, TagMode.TM_ADDBY_CATEGORY, TagOrientation.Horizontal, lp.Point); } catch {} } }",
    "Tag all windows": "var wins = new FilteredElementCollector(doc, doc.ActiveView.Id).OfCategory(BuiltInCategory.OST_Windows).WhereElementIsNotElementType().ToElements();\nforeach(var w in wins) { if(w.Location is LocationPoint lp) { try { var tag = IndependentTag.Create(doc, doc.ActiveView.Id, new Reference(w), false, TagMode.TM_ADDBY_CATEGORY, TagOrientation.Horizontal, lp.Point); } catch {} } }",
    "Create 3D View": "var type = new FilteredElementCollector(doc).OfClass(typeof(ViewFamilyType)).Cast<ViewFamilyType>().FirstOrDefault(x => x.ViewFamily == ViewFamily.ThreeDimensional);\nif(type != null) View3D.CreateIsometric(doc, type.Id);",
    "Create Sheet A101": "var tb = new FilteredElementCollector(doc).OfClass(typeof(FamilySymbol)).OfCategory(BuiltInCategory.OST_TitleBlocks).Cast<FamilySymbol>().FirstOrDefault();\nif (tb != null) { var sheet = ViewSheet.Create(doc, tb.Id); sheet.SheetNumber = \"A101\"; sheet.Name = \"First Floor Plan\"; }",
    "Create Sheet A102": "var tb = new FilteredElementCollector(doc).OfClass(typeof(FamilySymbol)).OfCategory(BuiltInCategory.OST_TitleBlocks).Cast<FamilySymbol>().FirstOrDefault();\nif (tb != null) { var sheet = ViewSheet.Create(doc, tb.Id); sheet.SheetNumber = \"A102\"; sheet.Name = \"Elevations\"; }",
    "Select all walls > 5m length": "var walls = new FilteredElementCollector(doc).OfClass(typeof(Wall)).Cast<Wall>().ToList();\nvar longWalls = new List<ElementId>();\nforeach(var w in walls) { var p = w.get_Parameter(BuiltInParameter.CURVE_ELEM_LENGTH); if(p != null && p.AsDouble() > 16.4042) longWalls.Add(w.Id); }\nuidoc.Selection.SetElementIds(longWalls);",
    "Select all rooms > 100 sqft": "var rooms = new FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Rooms).Cast<SpatialElement>().ToList();\nvar bigRooms = new List<ElementId>();\nforeach(var r in rooms) { if(r.Area > 100) bigRooms.Add(r.Id); }\nuidoc.Selection.SetElementIds(bigRooms);",
    "Delete unplaced rooms": "var rooms = new FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Rooms).WhereElementIsNotElementType().Cast<Room>().ToList();\nforeach(var r in rooms) { if(r.Location == null || r.Area == 0) doc.Delete(r.Id); }",
    "Pin all grids": "var grids = new FilteredElementCollector(doc).OfClass(typeof(Grid)).ToElements();\nforeach(var g in grids) { g.Pinned = true; }",
    "Unpin all grids": "var grids = new FilteredElementCollector(doc).OfClass(typeof(Grid)).ToElements();\nforeach(var g in grids) { g.Pinned = false; }",
    "Create 5 Levels": "for(int i=0; i<5; i++) { Level.Create(doc, i*10); }",
    "Create Level 2": "Level.Create(doc, 13.1234);",
    "Isolate Selection": "var ids = uidoc.Selection.GetElementIds();\nif(ids.Count > 0) doc.ActiveView.IsolateElementsTemporary(ids);",
    "Reset Isolate": "doc.ActiveView.DisableTemporaryViewMode(TemporaryViewMode.TemporaryHideIsolate);",
    "Select all Walls in the project": "var walls = new FilteredElementCollector(doc).OfClass(typeof(Wall)).ToElementIds();\nuidoc.Selection.SetElementIds(walls);",
    "Select all Doors on Level 1": "var level1 = new FilteredElementCollector(doc).OfClass(typeof(Level)).Cast<Level>().OrderBy(l => l.Elevation).FirstOrDefault();\nif(level1 != null) {\n    var doors = new FilteredElementCollector(doc).OfClass(typeof(FamilyInstance)).OfCategory(BuiltInCategory.OST_Doors).WhereElementIsNotElementType().Where(e => e.LevelId == level1.Id).ToElementIds();\n    uidoc.Selection.SetElementIds(doors);\n}",
    "Select all walls and Move them 1m right": "var walls = new FilteredElementCollector(doc).OfClass(typeof(Wall)).WhereElementIsNotElementType().ToElementIds();\nuidoc.Selection.SetElementIds(walls);\nElementTransformUtils.MoveElements(doc, walls, new XYZ(3.28084, 0, 0));",
    "Copy selected column 2m apart": "var ids = uidoc.Selection.GetElementIds();\nif (ids.Count > 0)\n{\n    ElementTransformUtils.CopyElements(doc, ids, new XYZ(6.56168, 0, 0));\n}",
    "Rotate the selected element 45 degrees": "var ids = uidoc.Selection.GetElementIds();\nif (ids.Count > 0)\n{\n    foreach(var id in ids)\n    {\n        Element e = doc.GetElement(id);\n        Line axis = Line.CreateBound(new XYZ(0,0,0), new XYZ(0,0,1));\n        if (e.Location is LocationPoint lp) axis = Line.CreateBound(lp.Point, lp.Point + new XYZ(0,0,1));\n        ElementTransformUtils.RotateElement(doc, id, axis, Math.PI / 4);\n    }\n}",
    "Create a new Sheet A101": "var titleBlocks = new FilteredElementCollector(doc).OfClass(typeof(FamilySymbol)).OfCategory(BuiltInCategory.OST_TitleBlocks).Cast<FamilySymbol>().ToList();\nFamilySymbol tb = titleBlocks.FirstOrDefault();\nif (tb != null)\n{\n    ViewSheet sheet = ViewSheet.Create(doc, tb.Id); sheet.Name = \"AI Generated Sheet\"; sheet.SheetNumber = \"A101\";\n}"
}